---
title: "A Story of Revisions to U.S. Employment"
author: "Chris Grieves"
format: revealjs
editor: visual
---


```{r, include=F}
#load libraries
library(tidyverse)
library(scales)

#pulled from here
#https://www.bls.gov/cew/revisions/qcew-revisions.csv
#get revisions to the QCEW
qcew_revisions <- read_csv("qcew-revisions.csv")

#read in the CES benchmark revisions preliminary and final
ces_revisions <- read_csv("ces_revisions.csv")

#add the date and the difference between the prelim and final
ces_revisions <- ces_revisions %>% 
                  mutate(diff=(Final-Prelim)*1000,
                         date = as.Date(paste0(March,"-3-1"),
                          format="%Y-%m-%d") ) 

#fix the names of the dataset so it's easier to use
names(qcew_revisions) <- tolower(make.names(names(qcew_revisions))) 

#I am only considering US revisions right now
qcew_revisions <- qcew_revisions %>% 
 #Subset data to national employment and drop establishment counts
                    filter(area=="United States",                
                           str_detect(field,"Employment")) %>%
#convert 'field' into a month name and number field
               mutate(monthn = trimws(str_remove(field," Employment")),
                           month = map_int(monthn,\(x){ which(x==month.name)})) %>% 
                    #CES only keep the initial QCEW values and its two revisions
                    select( year, quarter, initial.value,monthn, month,
                            first.revised.value) %>% 
                    #rename the values so that they're easier to use
                    rename( cut1 = initial.value, 
                            cut2 = first.revised.value) %>% 
                    #convert columns to numeric
                    #also create a date variable
                    mutate(across(matches("cut"),\(x){as.numeric(x)}),
                           date= as.Date(paste0(year,"-",month,"-1"),
                                         format="%Y-%m-%d"))
```

## U.S. Employment

U.S. Employment is measured by the Bureau of Labor Statistics (BLS) in two ways:

* The Current Employment Statistics (CES) Survey
  * Monthly employment survey asking a sample of employers "How many people do you have on your payroll?"
* The Quarterly Census of Employment and Wages (QCEW)
  * Large administrative program run by the states to collect employment and wages via the Unemployment Insurance (UI) program
  
## Why Two measurements?

* QCEW is a **census**
  * **census** - complete count of a population
  * Problem is that it is on a 4 month lag.
  * More realistically it is an 8 month lag.
* CES is produced monthly by a survey
  * **survey** - using random sampling to gather information about a population.
  * Only one month lag!
  * Subject to sampling error
  
  
## Who uses this data?

* **The Federal Reserve relies on this information to set interest rate and make other important economic decisions**
* If anyone paid attention to inflation over the last few years, this was an economic indicator to pay attention to


## QCEW

* Administrative programs are still subject to error.
  * Late data
  * Erroneous data

## Benchmarking

* CES **Benchmarks** to QCEW
  * **Benchmarking** is the process of setting a value to a perceived more credible value.

## QCEW Revisions

```{r, echo=F}
###cut1 cut2 plot
qcew_revisions %>% 
  pivot_longer(matches("cut")) %>% 
  ggplot(aes(x=date,y=value,col=name)) + 
  geom_line() +
  scale_y_continuous( labels= scales::comma_format(),
                      n.breaks = 8 ) + 
  labs(title="Initial QCEW Employment (Cut 1) vs First Revised (Cut 2)",
       col="Cut",
       y= "Employment",
       x= "Date")

```

# OK, those lines look really close, why should I care?

## If we look at the difference between cut 2 and cut 1, we get...

```{r echo=F}
#plot revisions BUT only highlight march
qcew_revisions %>%  
  mutate(rev=cut2-cut1) %>% 
  ggplot(aes(x=date,y=rev)) + 
  geom_line(alpha=.5) + 
  geom_hline(yintercept = 0,col=alpha("black",alpha = .5),linetype = 2)+
  scale_y_continuous( labels= scales::comma_format()) + 
  labs(title="QCEW Revisions Cut 1 to Cut 2",
       y= "Revision",
       x= "Date")


```


## Revisions are strictly positive starting in 2021

```{r echo=F}
#plot revisions BUT only highlight march
qcew_revisions %>%  
  mutate(rev=cut2-cut1) %>% 
  ggplot(aes(x=date,y=rev)) + 
  geom_line(alpha=.5) + 
  geom_hline(yintercept = 0,col=alpha("black",alpha = .5),linetype = 2)+
  scale_y_continuous( labels= scales::comma_format()) + 
  labs(title="QCEW Revisions Cut 1 to Cut 2",
       y= "Revision",
       x= "Date")
```

## CES Benchmark Revisions

* CES sets its "truth" to March of each year
